"use strict";(()=>{var y,p=!1;function _(){let e=document.getElementById("uv-frame");e??!1?e.addEventListener("load",()=>{p=!0,navbar.classList.add("hidden")}):(p=!0,t()),notch.addEventListener("mouseenter",()=>{p&&(navbar.classList.remove("hidden"),notch.classList.add("no-pointer-events"))}),navbar.addEventListener("mouseenter",()=>{clearTimeout(y)}),navbar.addEventListener("mouseleave",t);function t(){clearTimeout(y),y=setTimeout(()=>{p&&navbar.classList.add("hidden"),notch.classList.remove("no-pointer-events")},500)}document.addEventListener("touchstart",n=>{n.touches[0].clientY<navbar.offsetHeight&&p&&navbar.classList.remove("hidden")})}var $="/uv/sw.js",V=["localhost","127.0.0.1"];async function x(){if(!navigator.serviceWorker)throw location.protocol!=="https:"&&!V.includes(location.hostname)?new Error("Service workers cannot be registered without https."):new Error("Your browser doesn't support service workers.");await navigator.serviceWorker.register($)}function C(e,t,n){let o,a=!1;function i(){a||(a=!0,clearTimeout(o),t.call(this))}function r(){this.readyState==="complete"&&i.call(this)}e.addEventListener("load",function(){i.call(e.contentDocument)});function m(){let c=e.contentDocument;if(c.URL.indexOf("about:")!==0){if(c.readyState==="complete")i.call(c);else if(c.addEventListener("DOMContentLoaded",i),c.addEventListener("readystatechange",r),n){let s=c.defaultView.PerformanceObserver;new s(function(F){F.getEntries().length>0&&i.call(c)}).observe({type:"paint"})}}else o=setTimeout(m,1)}m()}function B(e,t){try{return{url:new URL(e).toString(),was_search:!1}}catch{}try{let n=new URL(`http://${e}`);if(n.hostname.includes("."))return{url:n.toString(),was_search:!1}}catch{}return{url:t.replace("%s",encodeURIComponent(e)),was_search:!0}}function I(){let e=new Date,t=e.getHours(),n=e.getMinutes(),o=e.getSeconds(),a="AM";t==0&&(t=12),t>12&&(t=t-12,a="PM"),t=t<10?"0"+t:t,n=n<10?"0"+n:n,o=o<10?"0"+o:o;let i=t+":"+n+":"+o+" "+a;document.getElementById("clockDisplay").innerText=i,document.getElementById("clockDisplay").textContent=i,setTimeout(I,1e3)}function S(){document.addEventListener("DOMContentLoaded",function(){let e=document.getElementById("tabButton"),t=document.getElementById("themeButton"),n=document.getElementById("dropdownContent2"),o=document.getElementById("dropdownColorContent"),a=[{title:"Google Classroom",favicon:"https://ssl.gstatic.com/classroom/favicon.png"},{title:"Google Drive",favicon:"https://ssl.gstatic.com/docs/doclist/images/drive_2022q3_32dp.png"},{title:"Google Docs",favicon:"https://ssl.gstatic.com/docs/documents/images/kix-favicon-2023q4.ico"},{title:"Sparx Maths",favicon:"https://t0.gstatic.com/faviconV2?client=SOCIAL&type=FAVICON&fallback_opts=TYPE,SIZE,URL&url=https://sparxmaths.com&size=32"},{title:"Google",favicon:"https://www.google.com/favicon.ico"},{title:"Desmos",favicon:"https://t0.gstatic.com/faviconV2?client=SOCIAL&type=FAVICON&fallback_opts=TYPE,SIZE,URL&url=http://desmos.com&size=32"},{title:"Desmos | Graphing Calculator",favicon:"https://t2.gstatic.com/faviconV2?client=SOCIAL&type=FAVICON&fallback_opts=TYPE,SIZE,URL&url=http://desmos.com/calculator&size=32"},{title:"Whirlwind",favicon:"/favicon.ico"}],i=[{title:"Original",colorCode:"#102a43"},{title:"Frapp\xE9",colorCode:"#303446"},{title:"Macchiato",colorCode:"#24273a"},{title:"Mocha",colorCode:"#1e1e2e"},{title:"Red",colorCode:"#d46a6c"},{title:"Yellow",colorCode:"#e9c377"},{title:"Green",colorCode:"#89a35f"},{title:"Purple",colorCode:"#755f91"},{title:"Pink",colorCode:"#a64d99"},{title:"OLED",colorCode:"#000000"},{title:"Dark",colorCode:"#31363F"}];(window.localStorage.getItem("tab_cloak")??!1)&&r(JSON.parse(window.localStorage.getItem("tab_cloak"))),(window.localStorage.getItem("theme")??!1)&&m(JSON.parse(window.localStorage.getItem("theme"))),a.forEach(c=>{let s=document.createElement("a");s.href="#";let v=document.createElement("img");v.src=c.favicon,v.alt=c.title,v.classList.add("tab-cloak-icon"),s.appendChild(v),s.classList.add("dropdown-item"),s.insertAdjacentText("beforeend",c.title),s.addEventListener("click",function(){r(c)}),n.appendChild(s)}),e.addEventListener("click",function(){n.style.display=n.style.display==="block"?"none":"block"}),t.addEventListener("click",function(){o.style.display=o.style.display==="block"?"none":"block"});function r(c){document.title=c.title;let s=document.getElementById("favicon");s.href=c.favicon,window.localStorage.setItem("tab_cloak",JSON.stringify(c))}function m(c){document.body.style.background=c,window.localStorage.setItem("theme",JSON.stringify(c))}i.forEach(c=>{let s=document.createElement("a");s.href="#",s.insertAdjacentText("afterbegin",c.title),s.classList.add("dropdown-item"),s.addEventListener("click",function(){m(c.colorCode)}),o.appendChild(s)})})}function D(){document.getElementById("openPopup").addEventListener("click",function(){document.getElementById("popup").classList.add("show")}),document.getElementById("closePopup").addEventListener("click",function(){let e=document.getElementById("popup");e.style.opacity="0",setTimeout(()=>{e.classList.remove("show"),e.style.opacity=""},300)})}var L=document.getElementById("uv-form"),u=document.getElementById("uv-address"),Y=document.getElementById("uv-search-engine"),G=document.getElementById("uv-error"),J=document.getElementById("uv-error-code"),T=new BareMux.BareMuxConnection("/baremux/worker.js"),O=document.getElementById("loader"),l=document.getElementById("uv-frame"),z=document.getElementById("navbar"),Z=document.getElementById("notch"),q=document.getElementById("settings"),X=document.getElementById("reload"),K=document.getElementById("back"),Q=document.getElementById("forward"),h=document.getElementById("proxied-content-wrapper"),R=document.getElementById("omnibox-wrapper"),f=document.getElementById("bookmarks-wrapper"),g=document.getElementById("bookmark-star"),w=document.getElementById("filled-star"),U=!0,M="bookmark_whirlwind_",d;g.addEventListener("click",function(){let e=E(l.contentWindow.location.href),t=ae(l.contentDocument),n=URL.parse(t,e);t===null&&(n=URL.parse(e).origin+"/favicon.ico");let o={favicon_url:n,name:l.contentDocument.title,url:e};d.push(o),b(window.localStorage,d),g.classList.add("none"),w.classList.remove("none")});w.addEventListener("click",function(){let e=[];for(let t of d)t.url==E(l.contentWindow.location.href)&&e.push(t);for(let t of e){let n;(n=d.indexOf(t))!==-1&&d.splice(n,1)}b(window.localStorage,d),g.classList.remove("none"),w.classList.add("none")});L.addEventListener("submit",k);X.addEventListener("click",function(){k(null,E(l.contentDocument.location.href))});K.addEventListener("click",function(){l.contentWindow.history.back()});Q.addEventListener("click",function(){l.contentWindow.history.forward()});var A=l.contentDocument.location.href,Ee=setInterval(function(){if(A!=l.contentDocument.location.href){u.value=E(l.contentDocument.location.href);let e=!1;for(let t of d)e=e||t.url==u.value;e?(g.classList.add("none"),w.classList.remove("none")):(w.classList.add("none"),g.classList.remove("none")),A=l.contentDocument.location.href,l.contentDocument.addEventListener("dragover",function(t){t.preventDefault()}),l.contentDocument.addEventListener("drop",function(t){t.preventDefault(),k(null,t.dataTransfer.getData("text/plain"))})}},50);async function k(e,t){(e??!1)&&e.preventDefault();let n=L.dataset.isSearchBar==="true";try{await x()}catch(i){throw G.textContent="Failed to register service worker.",J.textContent=i.toString(),i}let o=t??B(u.value,Y.value).url,a=(location.protocol==="https:"?"wss":"ws")+"://"+location.host+"/wisp/";await T.getTransport()!=="/epoxy/index.mjs"&&await T.setTransport("/epoxy/index.mjs",[{wisp:a}]),n&&ee(),l.src=H(o),O.classList.contains("none")||C(l,()=>{l.classList.add("loaded-frame"),O.classList.add("none")},!0)}function ee(){h.classList.replace("none","fullscreen"),R.appendChild(L),L.classList.add("omnibox"),L.dataset.isSearchBar="false",Z.classList.add("none"),z.classList.add("none"),R.appendChild(q);let e=window.localStorage,t=e.getItem("bookmarksEnabled");t==="true"?h.classList.add("with-bookmarks"):t==="false"?h.classList.remove("with-bookmarks"):(e.setItem("bookmarksEnabled",U),U?h.classList.add("with-bookmarks"):h.classList.remove("with-bookmarks")),b(e),g.classList.remove("none")}u.addEventListener("drop",function(e){e.preventDefault(),u.value=e.dataTransfer.getData("text/plain")});u.addEventListener("dragover",function(e){e.preventDefault()});u.addEventListener("dragenter",function(e){e.preventDefault(),u.select()});u.addEventListener("dragleave",function(e){e.preventDefault(),document.getSelection().removeAllRanges()});function N(e){return`<span class="bookmark-divider vhidden" id="divider_${e}"><svg id="chart" width="0.25rem" height="2rem"><line x1="0" y1="0" x2="0" y2="32" class="vertical-bar"></line></svg></span>`}function b(e,t){e.getItem("bookmarks")===null&&e.setItem("bookmarks","[]"),(t??!1)&&e.setItem("bookmarks",JSON.stringify(t)),d=JSON.parse(e.getItem("bookmarks")),f.innerHTML=N(0);for(let[n,o]of ce(d)){let a=document.createElement("span");a.classList.add("bookmark"),a.draggable=!0;let i=document.createElement("img");i.alt="bookmark favicon",i.classList.add("bookmark-favicon"),i.classList.add("bookmark-favicon-waiting"),i.draggable=!1,a.appendChild(i),a.insertAdjacentText("beforeend",o.name),a.dataset.url=o.url,a.id=`${M}${n}`,a.addEventListener("dragstart",function(r){r.currentTarget.classList.add("dragging"),r.dataTransfer.clearData(),r.dataTransfer.setData("text/plain",r.target.dataset.url),r.dataTransfer.setData("text/id",r.target.id),r.dataTransfer.setData(`text/whirlwind_bookmark_id__${r.target.id}`,"")}),a.addEventListener("dragend",function(r){r.currentTarget.classList.remove("dragging")}),re(o,i,a),f.appendChild(a),f.insertAdjacentHTML("beforeend",N(n+1)),a.onclick=()=>k(null,a.dataset.url)}f.addEventListener("dragover",function(n){n.preventDefault(),j(n,function(o,a,i){W(a,n,o,()=>o.classList.remove("vhidden"))})}),f.addEventListener("dragleave",function(n){for(let o of document.getElementsByClassName("bookmark-divider"))o.classList.add("vhidden")}),f.addEventListener("drop",function(n){j(n,function(o,a){W(a,n,o,function(i,r,m){let c=parseInt(m.id.substring(M.length));te(d,c,parseInt(r.id.substring(8))),b(window.localStorage,d)})})})}function te(e,t,n){return t<n&&(n-=1),e.splice(n,0,e.splice(t,1)[0]),e}function W(e,t,n,o){if(e<Math.hypot(t.target.clientWidth,t.target.clientHeight)){let a=null;for(let i of t.dataTransfer.types)i.startsWith("text/whirlwind_bookmark_id__")&&(a=document.getElementById(i.substring(28)));a.previousElementSibling.id==n.id||a.nextElementSibling.id==n.id||o(t,n,a)}}function j(e,t){let n=null,o=1/0,a=null;for(let i of document.getElementsByClassName("bookmark-divider")){i.classList.add("vhidden");let r=i.getBoundingClientRect(),m=(r.left+r.right)/2,c=(r.top+r.bottom)/2,s=Math.hypot(e.clientX-m,e.clientY-c);s<o&&(o=s,n=i,a=r)}n!==null&&t(n,o,a)}function H(e){return __uv$config.prefix+__uv$config.encodeUrl(e)}function E(e){return __uv$config.decodeUrl(e.split(__uv$config.prefix)[1])}function ne(e,t,n,o){try{let a=e.contentDocument.getElementsByTagName("img")[0],i=document.createElement("canvas");i.width=a.naturalWidth,i.height=a.naturalHeight,i.getContext("2d").drawImage(a,0,0),i.toBlob(function(r){r!==null&&(oe(o,r),P(URL.createObjectURL(r),t,n),window.addEventListener("beforeunload",function(){URL.revokeObjectURL(r)})),e.remove()})}catch(a){console.warn("failed to load favicon (cross platform issue?)"),console.log(a)}}function oe(e,t){ie(t).then(n=>{window.localStorage.setItem(`favicon_cache__${e.favicon_url}`,n)})}function ae(e){let t=null,n=e.getElementsByTagName("link");for(let o of n)(o.getAttribute("rel")=="icon"||o.getAttribute("rel")=="shortcut icon")&&(t=o.getAttribute("href"));return t}function ie(e){return new Promise((t,n)=>{let o=new FileReader;o.onloadend=()=>t(o.result),o.readAsDataURL(e)})}function re(e,t,n){let o=window.localStorage.getItem(`favicon_cache__${e.favicon_url}`);if(o??!1){fetch(o).then(i=>i.blob()).then(i=>{P(URL.createObjectURL(i),t,n),window.addEventListener("beforeunload",function(){URL.revokeObjectURL(i)})});return}let a=document.createElement("iframe");a.src=H(e.favicon_url),a.onload=()=>ne(a,t,n,e),document.getElementById("favicon-loaders").appendChild(a)}function P(e,t,n){t.src=e,t.classList.remove("bookmark-favicon-waiting"),n.removeChild(n.firstChild),n.insertBefore(t,n.firstChild),document.getElementById(n.id).innerHTML=n.innerHTML}function*ce(e,t=0){let n=t;for(let o of e)yield[n++,o]}_();I();S();D();})();
//# sourceMappingURL=index.min.js.map
