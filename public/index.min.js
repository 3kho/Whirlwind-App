"use strict";(()=>{var B,h=!1;function S(){let e=document.getElementById("uv-frame");e??!1?e.addEventListener("load",()=>{h=!0,navbar.classList.add("hidden")}):(h=!0,t()),notch.addEventListener("mouseenter",()=>{h&&(navbar.classList.remove("hidden"),notch.classList.add("no-pointer-events"))}),navbar.addEventListener("mouseenter",()=>{clearTimeout(B)}),navbar.addEventListener("mouseleave",t);function t(){clearTimeout(B),B=setTimeout(()=>{h&&navbar.classList.add("hidden"),notch.classList.remove("no-pointer-events")},500)}document.addEventListener("touchstart",n=>{n.touches[0].clientY<navbar.offsetHeight&&h&&navbar.classList.remove("hidden")})}var G="/uv/sw.js",J=["localhost","127.0.0.1"];async function T(){if(!navigator.serviceWorker)throw location.protocol!=="https:"&&!J.includes(location.hostname)?new Error("Service workers cannot be registered without https."):new Error("Your browser doesn't support service workers.");await navigator.serviceWorker.register(G)}function D(e,t,n){let o,a=!1;function i(){a||(a=!0,clearTimeout(o),t.call(this))}function r(){this.readyState==="complete"&&i.call(this)}e.addEventListener("load",function(){i.call(e.contentDocument)});function u(){let d=e.contentDocument;if(d.URL.indexOf("about:")!==0){if(d.readyState==="complete")i.call(d);else if(d.addEventListener("DOMContentLoaded",i),d.addEventListener("readystatechange",r),n){let g=d.defaultView.PerformanceObserver;new g(function(_){_.getEntries().length>0&&i.call(d)}).observe({type:"paint"})}}else o=setTimeout(u,1)}u()}function O(e,t){try{return{url:new URL(e).toString(),was_search:!1}}catch{}try{let n=new URL(`http://${e}`);if(n.hostname.includes("."))return{url:n.toString(),was_search:!1}}catch{}return{url:t.replace("%s",encodeURIComponent(e)),was_search:!0}}function C(){let e=new Date,t=e.getHours(),n=e.getMinutes(),o=e.getSeconds(),a="AM";t==0&&(t=12),t>12&&(t=t-12,a="PM"),t=t<10?"0"+t:t,n=n<10?"0"+n:n,o=o<10?"0"+o:o;let i=t+":"+n+":"+o+" "+a;document.getElementById("clockDisplay").innerText=i,document.getElementById("clockDisplay").textContent=i,setTimeout(C,1e3)}function R(){document.addEventListener("DOMContentLoaded",function(){function e(s){document.title=s.title;let c=document.getElementById("favicon");c.href=s.favicon,window.localStorage.setItem("tab_cloak",JSON.stringify(s))}function t(s){document.body.style.background=s,window.localStorage.setItem("theme",JSON.stringify(s))}function n(s){let c=document.getElementById("uv-search-engine");(c??!1)&&(c.value=s),window.localStorage.setItem("search_engine",JSON.stringify(s))}let o=document.getElementById("tabButton"),a=document.getElementById("themeButton"),i=document.getElementById("searchEngineButton"),r=document.getElementById("dropdownTabContent"),u=document.getElementById("dropdownColorContent"),d=document.getElementById("dropdownSearchContent"),g=[{title:"Google Classroom",favicon:"https://ssl.gstatic.com/classroom/favicon.png"},{title:"Google Drive",favicon:"https://ssl.gstatic.com/docs/doclist/images/drive_2022q3_32dp.png"},{title:"Google Docs",favicon:"https://ssl.gstatic.com/docs/documents/images/kix-favicon-2023q4.ico"},{title:"Sparx Maths",favicon:"https://t0.gstatic.com/faviconV2?client=SOCIAL&type=FAVICON&fallback_opts=TYPE,SIZE,URL&url=https://sparxmaths.com&size=32"},{title:"Google",favicon:"https://t0.gstatic.com/faviconV2?client=SOCIAL&type=FAVICON&fallback_opts=TYPE,SIZE,URL&url=https://www.google.com/favicon.ico&size=32"},{title:"Desmos",favicon:"https://t0.gstatic.com/faviconV2?client=SOCIAL&type=FAVICON&fallback_opts=TYPE,SIZE,URL&url=http://desmos.com&size=32"},{title:"Desmos | Graphing Calculator",favicon:"https://t0.gstatic.com/faviconV2?client=SOCIAL&type=FAVICON&fallback_opts=TYPE,SIZE,URL&url=http://desmos.com/calculator&size=32"},{title:"Whirlwind",favicon:"/favicon.ico"}],x=[{title:"Original",colorCode:"#102a43"},{title:"Frapp\xE9",colorCode:"#303446"},{title:"Macchiato",colorCode:"#24273a"},{title:"Mocha",colorCode:"#1e1e2e"},{title:"Red",colorCode:"#d46a6c"},{title:"Yellow",colorCode:"#e9c377"},{title:"Green",colorCode:"#89a35f"},{title:"Purple",colorCode:"#755f91"},{title:"Pink",colorCode:"#a64d99"},{title:"OLED",colorCode:"#000000"},{title:"Dark",colorCode:"#31363F"}],_=[{title:"Google",template:"https://www.google.com/search?q=%s"},{title:"DuckDuckGo",template:"https://duckduckgo.com/?q=%s"},{title:"Bing",template:"https://www.bing.com/search?q=%s"},{title:"Yahoo",template:"https://search.yahoo.com/search?p=%s"}];(window.localStorage.getItem("tab_cloak")??!1)&&e(JSON.parse(window.localStorage.getItem("tab_cloak"))),(window.localStorage.getItem("theme")??!1)&&t(JSON.parse(window.localStorage.getItem("theme"))),(window.localStorage.getItem("search_engine")??!1)&&n(JSON.parse(window.localStorage.getItem("search_engine"))),g.forEach(s=>{let c=document.createElement("a");c.href="#";let b=document.createElement("img");b.src=s.favicon,b.alt=s.title,b.classList.add("tab-cloak-icon"),c.appendChild(b),c.classList.add("dropdown-item"),c.insertAdjacentText("beforeend",s.title),c.addEventListener("click",function(){e(s)}),r.appendChild(c)}),x.forEach(s=>{let c=document.createElement("a");c.href="#",c.insertAdjacentText("afterbegin",s.title),c.classList.add("dropdown-item"),c.addEventListener("click",function(){t(s.colorCode)}),u.appendChild(c)}),_.forEach(s=>{let c=document.createElement("a");c.href="#",c.insertAdjacentText("afterbegin",s.title),c.classList.add("dropdown-item"),c.addEventListener("click",function(){n(s.template)}),d.appendChild(c)}),o.addEventListener("click",function(){r.style.display=r.style.display==="block"?"none":"block"}),a.addEventListener("click",function(){u.style.display=u.style.display==="block"?"none":"block"}),i.addEventListener("click",function(){d.style.display=d.style.display==="block"?"none":"block"})})}function U(){document.getElementById("openPopup").addEventListener("click",function(){document.getElementById("popup").classList.add("show")}),document.getElementById("closePopup").addEventListener("click",function(){let e=document.getElementById("popup");e.style.opacity="0",setTimeout(()=>{e.classList.remove("show"),e.style.opacity=""},300)})}var k=document.getElementById("uv-form"),f=document.getElementById("uv-address"),q=document.getElementById("uv-search-engine"),z=document.getElementById("uv-error"),Z=document.getElementById("uv-error-code"),A=new BareMux.BareMuxConnection("/baremux/worker.js"),M=document.getElementById("loader"),l=document.getElementById("uv-frame"),X=document.getElementById("navbar"),K=document.getElementById("notch"),Q=document.getElementById("settings"),ee=document.getElementById("reload"),te=document.getElementById("back"),ne=document.getElementById("forward"),w=document.getElementById("proxied-content-wrapper"),N=document.getElementById("omnibox-wrapper"),p=document.getElementById("bookmarks-wrapper"),v=document.getElementById("bookmark-star"),L=document.getElementById("filled-star"),j=!0,P="bookmark_whirlwind_",m;v.addEventListener("click",function(){let e=I(l.contentWindow.location.href),t=ce(l.contentDocument),n=URL.parse(t,e);t===null&&(n=URL.parse(e).origin+"/favicon.ico");let o={favicon_url:n,name:l.contentDocument.title,url:e};m.push(o),y(window.localStorage,m),v.classList.add("none"),L.classList.remove("none")});L.addEventListener("click",function(){let e=[];for(let t of m)t.url==I(l.contentWindow.location.href)&&e.push(t);for(let t of e){let n;(n=m.indexOf(t))!==-1&&m.splice(n,1)}y(window.localStorage,m),v.classList.remove("none"),L.classList.add("none")});k.addEventListener("submit",E);ee.addEventListener("click",function(){E(null,I(l.contentDocument.location.href))});te.addEventListener("click",function(){l.contentWindow.history.back()});ne.addEventListener("click",function(){l.contentWindow.history.forward()});var W=l.contentDocument.location.href,_e=setInterval(function(){if(W!=l.contentDocument.location.href){f.value=I(l.contentDocument.location.href);let e=!1;for(let t of m)e=e||t.url==f.value;e?(v.classList.add("none"),L.classList.remove("none")):(L.classList.add("none"),v.classList.remove("none")),W=l.contentDocument.location.href,l.contentDocument.addEventListener("dragover",function(t){t.preventDefault()}),l.contentDocument.addEventListener("drop",function(t){t.preventDefault(),E(null,t.dataTransfer.getData("text/plain"))})}},50);async function E(e,t){(e??!1)&&e.preventDefault();let n=k.dataset.isSearchBar==="true";try{await T()}catch(i){throw z.textContent="Failed to register service worker.",Z.textContent=i.toString(),i}let o=t??O(f.value,q.value).url,a=(location.protocol==="https:"?"wss":"ws")+"://"+location.host+"/wisp/";await A.getTransport()!=="/epoxy/index.mjs"&&await A.setTransport("/epoxy/index.mjs",[{wisp:a}]),n&&oe(),l.src=V(o),M.classList.contains("none")||D(l,()=>{l.classList.add("loaded-frame"),M.classList.add("none")},!0)}function oe(){w.classList.replace("none","fullscreen"),N.appendChild(k),k.classList.add("omnibox"),k.dataset.isSearchBar="false",K.classList.add("none"),X.classList.add("none"),N.appendChild(Q);let e=window.localStorage,t=e.getItem("bookmarksEnabled");t==="true"?w.classList.add("with-bookmarks"):t==="false"?w.classList.remove("with-bookmarks"):(e.setItem("bookmarksEnabled",j),j?w.classList.add("with-bookmarks"):w.classList.remove("with-bookmarks")),y(e),v.classList.remove("none")}f.addEventListener("drop",function(e){e.preventDefault(),f.value=e.dataTransfer.getData("text/plain")});f.addEventListener("dragover",function(e){e.preventDefault()});f.addEventListener("dragenter",function(e){e.preventDefault(),f.select()});f.addEventListener("dragleave",function(e){e.preventDefault(),document.getSelection().removeAllRanges()});function F(e){return`<span class="bookmark-divider vhidden" id="divider_${e}"><svg id="chart" width="0.25rem" height="2rem"><line x1="0" y1="0" x2="0" y2="32" class="vertical-bar"></line></svg></span>`}function y(e,t){e.getItem("bookmarks")===null&&e.setItem("bookmarks","[]"),(t??!1)&&e.setItem("bookmarks",JSON.stringify(t)),m=JSON.parse(e.getItem("bookmarks")),p.innerHTML=F(0);for(let[n,o]of de(m)){let a=document.createElement("span");a.classList.add("bookmark"),a.draggable=!0;let i=document.createElement("img");i.alt="bookmark favicon",i.classList.add("bookmark-favicon"),i.classList.add("bookmark-favicon-waiting"),i.draggable=!1,a.appendChild(i),a.insertAdjacentText("beforeend",o.name),a.dataset.url=o.url,a.id=`${P}${n}`,a.addEventListener("dragstart",function(r){r.currentTarget.classList.add("dragging"),r.dataTransfer.clearData(),r.dataTransfer.setData("text/plain",r.target.dataset.url),r.dataTransfer.setData("text/id",r.target.id),r.dataTransfer.setData(`text/whirlwind_bookmark_id__${r.target.id}`,"")}),a.addEventListener("dragend",function(r){r.currentTarget.classList.remove("dragging")}),le(o,i,a),p.appendChild(a),p.insertAdjacentHTML("beforeend",F(n+1)),a.onclick=()=>E(null,a.dataset.url)}p.addEventListener("dragover",function(n){n.preventDefault(),$(n,function(o,a,i){H(a,n,o,()=>o.classList.remove("vhidden"))})}),p.addEventListener("dragleave",function(n){for(let o of document.getElementsByClassName("bookmark-divider"))o.classList.add("vhidden")}),p.addEventListener("drop",function(n){$(n,function(o,a){H(a,n,o,function(i,r,u){let d=parseInt(u.id.substring(P.length));ae(m,d,parseInt(r.id.substring(8))),y(window.localStorage,m)})})})}function ae(e,t,n){return t<n&&(n-=1),e.splice(n,0,e.splice(t,1)[0]),e}function H(e,t,n,o){if(e<Math.hypot(t.target.clientWidth,t.target.clientHeight)){let a=null;for(let i of t.dataTransfer.types)i.startsWith("text/whirlwind_bookmark_id__")&&(a=document.getElementById(i.substring(28)));a.previousElementSibling.id==n.id||a.nextElementSibling.id==n.id||o(t,n,a)}}function $(e,t){let n=null,o=1/0,a=null;for(let i of document.getElementsByClassName("bookmark-divider")){i.classList.add("vhidden");let r=i.getBoundingClientRect(),u=(r.left+r.right)/2,d=(r.top+r.bottom)/2,g=Math.hypot(e.clientX-u,e.clientY-d);g<o&&(o=g,n=i,a=r)}n!==null&&t(n,o,a)}function V(e){return __uv$config.prefix+__uv$config.encodeUrl(e)}function I(e){return __uv$config.decodeUrl(e.split(__uv$config.prefix)[1])}function ie(e,t,n,o){try{let a=e.contentDocument.getElementsByTagName("img")[0],i=document.createElement("canvas");i.width=a.naturalWidth,i.height=a.naturalHeight,i.getContext("2d").drawImage(a,0,0),i.toBlob(function(r){r!==null&&(re(o,r),Y(URL.createObjectURL(r),t,n),window.addEventListener("beforeunload",function(){URL.revokeObjectURL(r)})),e.remove()})}catch(a){console.warn("failed to load favicon (cross platform issue?)"),console.log(a)}}function re(e,t){se(t).then(n=>{window.localStorage.setItem(`favicon_cache__${e.favicon_url}`,n)})}function ce(e){let t=null,n=e.getElementsByTagName("link");for(let o of n)(o.getAttribute("rel")=="icon"||o.getAttribute("rel")=="shortcut icon")&&(t=o.getAttribute("href"));return t}function se(e){return new Promise((t,n)=>{let o=new FileReader;o.onloadend=()=>t(o.result),o.readAsDataURL(e)})}function le(e,t,n){let o=window.localStorage.getItem(`favicon_cache__${e.favicon_url}`);if(o??!1){fetch(o).then(i=>i.blob()).then(i=>{Y(URL.createObjectURL(i),t,n),window.addEventListener("beforeunload",function(){URL.revokeObjectURL(i)})});return}let a=document.createElement("iframe");a.src=V(e.favicon_url),a.onload=()=>ie(a,t,n,e),document.getElementById("favicon-loaders").appendChild(a)}function Y(e,t,n){t.src=e,t.classList.remove("bookmark-favicon-waiting"),n.removeChild(n.firstChild),n.insertBefore(t,n.firstChild),document.getElementById(n.id).innerHTML=n.innerHTML}function*de(e,t=0){let n=t;for(let o of e)yield[n++,o]}S();C();R();U();})();
//# sourceMappingURL=index.min.js.map
